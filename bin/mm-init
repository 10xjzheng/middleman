#!/usr/bin/env ruby
require File.join(File.dirname(File.dirname(__FILE__)), 'lib', 'middleman')
require "thor"
require "thor/group"

module Middleman
  class Generator < ::Thor::Group
    include Thor::Actions
    
    def self.source_root
      File.join(File.dirname(__FILE__), '..', 'lib', 'middleman', 'template')
    end
    
    argument :location, :type => :string, :desc => "New project location"
    
    class_option :css_dir, :default => "stylesheets", :desc => 'The path to the css files'
    class_option :js_dir, :default => "javascripts", :desc => 'The path to the javascript files'
    class_option :images_dir, :default => "images", :desc => 'The path to the image files'
    
    def create_project
      template "config.tt", File.join(location, "config.rb")
      directory "views", File.join(location, "views")
      empty_directory File.join(location, "public", options[:css_dir])
      empty_directory File.join(location, "public", options[:js_dir])
      empty_directory File.join(location, "public", options[:images_dir])
    end
  end
end

Middleman::Generator.start